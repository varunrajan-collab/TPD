<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Competency Simulation</title>
    <style>
        :root {
            /* NEW AESTHETIC: Airy, Clinical, Professional */
            
            /* Backgrounds */
            --bg-body: #F0F9FF;       /* Very Pale Blue */
            --bg-card: #FFFFFF;
            --bg-neutral: #F8FAFC;    /* Slate 50 */
            
            /* Text Colors */
            --text-primary: #0F172A;  /* Slate 900 */
            --text-secondary: #475569;/* Slate 600 */
            --text-muted: #94A3B8;    /* Slate 400 */
            
            /* Accents */
            --accent-color: #0EA5E9;  /* Sky 500 */
            --accent-hover: #0284C7;  /* Sky 600 */
            --accent-light: #E0F2FE;  /* Sky 100 */
            
            /* Status Indicators (Subtle borders) */
            --border-default: #E2E8F0;
            --border-focus: #0EA5E9;
            
            /* Spacing & Structure */
            --radius-card: 12px;      /* Moderately rounded */
            --radius-btn: 6px;        /* Standard button */
            --shadow-soft: 0 4px 6px -1px rgba(0, 0, 0, 0.05), 0 2px 4px -1px rgba(0, 0, 0, 0.03);
            
            --font-main: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--font-main);
            background-color: var(--bg-body);
            color: var(--text-primary);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        #app-container {
            background: var(--bg-card);
            width: 100%;
            max-width: 620px;
            border-radius: var(--radius-card);
            box-shadow: var(--shadow-soft);
            overflow: hidden;
            border: 1px solid var(--border-default);
            display: flex;
            flex-direction: column;
            min-height: 400px;
        }

        /* Top Bar */
        .status-bar {
            height: 4px;
            background: var(--bg-neutral);
            width: 100%;
        }
        
        .status-fill {
            height: 100%;
            background: var(--accent-color);
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Content Area */
        .content-area {
            padding: 40px;
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        /* Typography */
        h1 {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
            margin: 0 0 16px 0;
            line-height: 1.4;
        }

        h2 {
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1.5px;
            color: var(--text-secondary);
            margin: 0 0 24px 0;
            font-weight: 600;
        }

        p {
            color: var(--text-secondary);
            margin-bottom: 24px;
            font-size: 1rem;
        }

        /* Scenario Box */
        .scenario-box {
            background: var(--bg-neutral);
            border-left: 3px solid var(--accent-color);
            padding: 24px;
            margin-bottom: 32px;
            border-radius: 0 var(--radius-btn) var(--radius-btn) 0;
        }
        
        .scenario-label {
            display: block;
            font-size: 0.75rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        /* Options */
        .options-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        button.option-btn {
            background: var(--bg-card);
            border: 1px solid var(--border-default);
            padding: 16px 20px;
            border-radius: var(--radius-btn);
            text-align: left;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.95rem;
            color: var(--text-primary);
            font-family: var(--font-main);
            position: relative;
        }

        button.option-btn:hover {
            border-color: var(--accent-color);
            background: var(--bg-neutral);
        }

        button.option-btn:focus {
            outline: 2px solid var(--accent-light);
            border-color: var(--accent-color);
        }

        .option-prefix {
            font-weight: 600;
            color: var(--text-secondary);
            margin-right: 8px;
        }

        /* Feedback Section */
        .feedback-section {
            animation: fadeIn 0.4s ease-out;
        }

        .feedback-card {
            padding: 0;
            margin-bottom: 24px;
        }
        
        .feedback-title {
            font-size: 0.9rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
        }

        .feedback-text {
            color: var(--text-secondary);
            font-size: 1rem;
            line-height: 1.6;
        }
        
        .analysis-block {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid var(--border-default);
        }

        .retry-prompt {
            margin-top: 20px;
            font-weight: 600;
            color: var(--accent-color);
            font-size: 0.95rem;
        }

        /* Primary Action Button */
        .primary-btn {
            background-color: var(--accent-color);
            color: white;
            border: none;
            padding: 14px 28px;
            border-radius: var(--radius-btn);
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: background 0.2s;
            align-self: flex-start;
            margin-top: 20px;
        }

        .primary-btn:hover {
            background-color: var(--accent-hover);
        }

        .restart-btn {
            background: transparent;
            border: 1px solid var(--border-default);
            color: var(--text-secondary);
            padding: 12px 24px;
            border-radius: var(--radius-btn);
            font-size: 0.9rem;
            cursor: pointer;
            margin-top: 32px;
        }

        .restart-btn:hover {
            border-color: var(--text-primary);
            color: var(--text-primary);
        }

        /* Utility */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>

<div id="app-container">
    <div class="status-bar">
        <div class="status-fill" id="progress"></div>
    </div>
    <div id="content" class="content-area">
        <!-- Dynamic Content -->
    </div>
</div>

<script>
    // --- DATA ---
    const data = {
        competency: "Clearly communicates the lesson’s objectives and key concepts at the outset.",
        
        level1: {
            scenario: "You are standing at the front of the room. The bell has just rung, and students are settling into their seats, chatting and pulling out materials. You need to transition them into learning mode effectively.",
            question: "How do you begin the lesson to ensure students are focused and clear on the goal?",
            options: [
                {
                    id: "A",
                    label: "Option A",
                    text: "Review the previous day's homework immediately to ensure everyone did it.",
                    type: "confusing",
                    consequence: "Students switch to 'task mode' but are unsure what the NEW learning goal is. Engagement is limited to compliance.",
                    explanation: "This choice prioritizes administrative checks over instructional clarity. It fails to orient students toward the new learning, leading to a disjointed start."
                },
                {
                    id: "B",
                    label: "Option B",
                    text: "Address the class and state the specific learning objective, explaining what they will be able to do by the end of the period and why it is relevant.",
                    type: "aligned",
                    consequence: "The shift in energy is immediate. By explicitly stating the learning objective and its relevance, you have given students a 'hook.' They understand why they are here today. This clarity reduces low-level disruption because students aren't waiting to figure out what's happening—they are already oriented toward the goal.",
                    explanation: "Framing the destination helps students organize incoming information."
                },
                {
                    id: "C",
                    label: "Option C",
                    text: "Tell the students to open page 45 and start reading silently.",
                    type: "misaligned",
                    consequence: "Students comply mechanically, but some are visibly disengaged or confused about the purpose.",
                    explanation: "Assigning a task without context creates passive compliance rather than active engagement. The objective remains hidden."
                }
            ]
        },

        level2: {
            scenario: "Midway through the explanation, a student raises their hand and asks: 'Why do we need to learn this? It seems useless.' Other students stop taking notes to listen.",
            question: "How do you respond to this interruption?",
            options: [
                {
                    id: "A",
                    label: "Option A",
                    text: "Explain a specific real-world application of the concept relevant to their lives.",
                    type: "aligned",
                    consequence: "The student perks up. The class becomes more attentive as they realize this is a tool they can use.",
                    explanation: "Connecting content to reality validates the objective."
                },
                {
                    id: "B",
                    label: "Option B",
                    text: "Tell them it will be on the final exam so they need to know it.",
                    type: "misaligned",
                    consequence: "The student nods but looks bored. Motivation shifts from learning to fear of failure.",
                    explanation: "Using grades as justification bypasses the intrinsic value of the objective. It signals that the content itself isn't valuable, only the grade is.",
                    rightCourse: "The teacher should have connected the concept to a real-world problem or student interest."
                },
                {
                    id: "C",
                    label: "Option C",
                    text: "Ask them to hold all questions until the end of the lecture.",
                    type: "confusing",
                    consequence: "The student disengages. The 'teachable moment' is lost.",
                    explanation: "While this protects the timeline, it signals that the lesson plan is more important than student understanding.",
                    rightCourse: "The teacher should have used the question to reinforce the lesson's relevance immediately."
                }
            ]
        },

        finalTakeaway: "Clear communication of goals—and the 'why' behind them—helps students stay focused, confident, and engaged throughout the lesson."
    };

    // --- STATE ---
    const contentDiv = document.getElementById('content');
    const progressBar = document.getElementById('progress');
    let currentStep = 0; // 0: Competency, 1: Lvl1, 2: Lvl2, 3: End

    // --- RENDERERS ---

    function setProgress(pct) {
        progressBar.style.width = `${pct}%`;
    }

    // STEP 1: COMPETENCY
    function renderCompetency() {
        currentStep = 0;
        setProgress(10);
        contentDiv.innerHTML = `
            <div style="animation: fadeIn 0.5s ease-out;">
                <h2>Competency Focus</h2>
                <h1>${data.competency}</h1>
                <button class="primary-btn" onclick="renderLevel1()">Begin Simulation</button>
            </div>
        `;
    }

    // STEP 2 & 3: LEVEL 1 SCENARIO
    function renderLevel1() {
        currentStep = 1;
        setProgress(30);
        
        const optionsHTML = data.level1.options.map(opt => `
            <button class="option-btn" onclick="handleDecision('level1', '${opt.type}', '${opt.id}')">
                <span class="option-prefix">${opt.label}:</span> ${opt.text}
            </button>
        `).join('');

        contentDiv.innerHTML = `
            <div style="animation: fadeIn 0.5s ease-out;">
                <div class="scenario-box">
                    <span class="scenario-label">Scenario 1</span>
                    ${data.level1.scenario}
                </div>
                <p><strong>${data.level1.question}</strong></p>
                <div class="options-list">
                    ${optionsHTML}
                </div>
            </div>
        `;
    }

    // STEP 4, 5, 6: DECISION LOGIC
    window.handleDecision = function(level, type, optId) {
        const levelData = data[level];
        const selectedOpt = levelData.options.find(o => o.id === optId);

        if (type === 'aligned') {
            // SUCCESS LOGIC
            if (level === 'level1') {
                renderLvl1Success(selectedOpt);
            } else {
                renderFinalSuccess(selectedOpt);
            }
        } else {
            // FAILURE/RETRY LOGIC
            renderFailure(selectedOpt, level);
        }
    };

    // STEP 5: ALIGNED RESPONSE (LEVEL 1)
    function renderLvl1Success(option) {
        setProgress(60);
        contentDiv.innerHTML = `
            <div class="feedback-section">
                <div class="feedback-card">
                    <div class="feedback-title">Outcome</div>
                    <div class="feedback-text">${option.consequence}</div>
                </div>
                <button class="primary-btn" onclick="renderLevel2()">Continue to Next Situation</button>
            </div>
        `;
    }

    // STEP 6: FOLLOW UP SCENARIO
    function renderLevel2() {
        currentStep = 2;
        setProgress(80);
        
        const optionsHTML = data.level2.options.map(opt => `
            <button class="option-btn" onclick="handleDecision('level2', '${opt.type}', '${opt.id}')">
                <span class="option-prefix">${opt.label}:</span> ${opt.text}
            </button>
        `).join('');

        contentDiv.innerHTML = `
            <div style="animation: fadeIn 0.5s ease-out;">
                <div class="scenario-box">
                    <span class="scenario-label">Scenario 2</span>
                    ${data.level2.scenario}
                </div>
                <p><strong>${data.level2.question}</strong></p>
                <div class="options-list">
                    ${optionsHTML}
                </div>
            </div>
        `;
    }

    // FAILURE/RETRY LOGIC
    function renderFailure(option, level) {
        setProgress(currentStep === 1 ? 30 : 80); // Keep progress static or revert slightly
        
        // Determine which function to call to retry
        const retryFunction = level === 'level1' ? 'renderLevel1()' : 'renderLevel2()';

        contentDiv.innerHTML = `
            <div class="feedback-section">
                <div class="feedback-card">
                    <div class="feedback-title">Classroom Consequence</div>
                    <div class="feedback-text">${option.consequence}</div>
                    
                    <div class="analysis-block">
                        <div class="feedback-title">Analysis</div>
                        <div class="feedback-text">${option.explanation}</div>
                    </div>

                    <div class="retry-prompt">
                        Now that you know the impact, would you like to try again?
                    </div>
                </div>
                <button class="primary-btn" onclick="${retryFunction}">Try Again</button>
            </div>
        `;
    }

    // STEP 7: SUCCESS ENDING
    function renderFinalSuccess(option) {
        setProgress(100);
        contentDiv.innerHTML = `
            <div class="feedback-section">
                <div class="feedback-card">
                    <div class="feedback-title">Outcome</div>
                    <div class="feedback-text">${option.consequence}</div>
                    
                    <div class="analysis-block">
                        <div class="feedback-title">Professional Takeaway</div>
                        <div class="feedback-text">${data.finalTakeaway}</div>
                    </div>
                </div>
                <button class="restart-btn" onclick="renderCompetency()">Run Simulation Again</button>
            </div>
        `;
    }

    // INITIALIZE
    renderCompetency();

</script>

</body>
</html>
